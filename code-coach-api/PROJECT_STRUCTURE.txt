CODE COACH BACKEND - FINAL PROJECT STRUCTURE
==============================================

code-coach-api/
â”‚
â”œâ”€â”€ ğŸ“„ pom.xml                              [Maven Parent - Dependency Management]
â”œâ”€â”€ ğŸ“„ README.md                            [Documentation technique complÃ¨te]
â”œâ”€â”€ ğŸ“„ QUICKSTART.md                        [DÃ©marrage en 5 minutes]
â”œâ”€â”€ ğŸ“„ ARCHITECTURE.md                      [Architecture dÃ©taillÃ©e + dÃ©cisions]
â”œâ”€â”€ ğŸ“„ STEP1_COMPLETION.md                  [Checklist de complÃ©tion STEP 1]
â”œâ”€â”€ ğŸ“„ VISUAL_SUMMARY.md                    [RÃ©sumÃ© visual]
â”œâ”€â”€ ğŸ“„ FIXTURES.sql                         [DonnÃ©es d'exemple SQL]
â”œâ”€â”€ ğŸ“„ .gitignore                           [Git ignore Maven + IDE]
â”‚
â”œâ”€â”€ ğŸ“ shared-module/                       [DTOs, Exceptions, Configs]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/shared/
â”‚       â”œâ”€â”€ dto/
â”‚       â”‚   â”œâ”€â”€ AuthRequestDto.java
â”‚       â”‚   â”œâ”€â”€ AuthResponseDto.java
â”‚       â”‚   â”œâ”€â”€ UserRegisterDto.java
â”‚       â”‚   â”œâ”€â”€ UserDto.java
â”‚       â”‚   â”œâ”€â”€ ExerciseDto.java
â”‚       â”‚   â”œâ”€â”€ SubmissionDto.java
â”‚       â”‚   â””â”€â”€ SubmissionResultDto.java
â”‚       â””â”€â”€ entity/  [Shared entity references]
â”‚
â”œâ”€â”€ ğŸ“ auth-module/                         [JWT + Spring Security]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/auth/
â”‚       â”œâ”€â”€ jwt/
â”‚       â”‚   â””â”€â”€ JwtTokenProvider.java       [Generate/Validate JWT tokens]
â”‚       â”œâ”€â”€ security/
â”‚       â”‚   â””â”€â”€ JwtAuthenticationFilter.java [Extract & validate JWT]
â”‚       â”œâ”€â”€ config/
â”‚       â”‚   â”œâ”€â”€ SecurityConfig.java         [Spring Security stateless]
â”‚       â”‚   â””â”€â”€ AuthModuleConfig.java       [@ComponentScan config]
â”‚       â””â”€â”€ controller/
â”‚           â””â”€â”€ AuthController.java         [POST /auth/register, /auth/login]
â”‚
â”œâ”€â”€ ğŸ“ user-module/                         [User CRUD + Password Hashing]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/user/
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â””â”€â”€ User.java                   [LEARNER/INSTRUCTOR/ADMIN roles]
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â””â”€â”€ UserRepository.java         [JPA interface]
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â””â”€â”€ UserService.java            [Register + Validation]
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ UserModuleConfig.java
â”‚
â”œâ”€â”€ ğŸ“ content-module/                      [Curriculum - Tracks & Exercises]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/content/
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â”œâ”€â”€ Track.java                  [Pistes d'apprentissage]
â”‚       â”‚   â””â”€â”€ Exercise.java               [Exercices + test_code secret]
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ TrackRepository.java
â”‚       â”‚   â””â”€â”€ ExerciseRepository.java
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â””â”€â”€ ExerciseService.java        [Read curriculum only]
â”‚       â”œâ”€â”€ controller/
â”‚       â”‚   â””â”€â”€ ExerciseController.java     [GET /exercises/track/{id}]
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ ContentModuleConfig.java
â”‚
â”œâ”€â”€ ğŸ“ submission-module/                   [Soumissions Code - Versioning]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/submission/
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â”œâ”€â”€ Submission.java             [Immutable code submissions]
â”‚       â”‚   â””â”€â”€ SubmissionResult.java       [Errors + test results]
â”‚       â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ SubmissionRepository.java
â”‚       â”‚   â””â”€â”€ SubmissionResultRepository.java
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â””â”€â”€ SubmissionService.java      [Create + Versioning]
â”‚       â”œâ”€â”€ controller/
â”‚       â”‚   â””â”€â”€ SubmissionController.java   [POST/GET submissions]
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ SubmissionModuleConfig.java
â”‚
â”œâ”€â”€ ğŸ“ runner-module/                       [Execution Orchestration [TODO STEP 2]]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/runner/
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ RunnerModuleConfig.java     [Placeholder]
â”‚
â”œâ”€â”€ ğŸ“ coach-module/                        [IA Socratique [TODO STEP 3]]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/coach/
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â”œâ”€â”€ CoachConversation.java      [Thread de coaching]
â”‚       â”‚   â””â”€â”€ CoachMessage.java           [QUESTION/HINT/PSEUDO_CODE/...]
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ CoachModuleConfig.java      [Placeholder]
â”‚
â”œâ”€â”€ ğŸ“ progress-module/                     [Progression & Gamification [TODO STEP 2]]
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/main/java/com/codecoach/progress/
â”‚       â”œâ”€â”€ entity/
â”‚       â”‚   â””â”€â”€ SkillProgress.java          [Mastery tracking]
â”‚       â””â”€â”€ config/
â”‚           â””â”€â”€ ProgressModuleConfig.java   [Placeholder]
â”‚
â””â”€â”€ ğŸ“ api-module/                          [Spring Boot Application Principale]
    â”œâ”€â”€ pom.xml
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ main/
    â”‚   â”‚   â”œâ”€â”€ java/com/codecoach/
    â”‚   â”‚   â”‚   â””â”€â”€ CodeCoachApplication.java   [Spring Boot Main]
    â”‚   â”‚   â””â”€â”€ resources/
    â”‚   â”‚       â”œâ”€â”€ application.yml             [Configuration PostgreSQL, JWT, Redis]
    â”‚   â”‚       â””â”€â”€ db/migration/
    â”‚   â”‚           â”œâ”€â”€ V1__init_user_table.sql
    â”‚   â”‚           â”œâ”€â”€ V2__init_track_table.sql
    â”‚   â”‚           â”œâ”€â”€ V3__init_exercise_table.sql
    â”‚   â”‚           â”œâ”€â”€ V4__init_submission_table.sql
    â”‚   â”‚           â”œâ”€â”€ V5__init_submission_result_table.sql
    â”‚   â”‚           â”œâ”€â”€ V6__init_coach_conversation_table.sql
    â”‚   â”‚           â”œâ”€â”€ V7__init_coach_message_table.sql
    â”‚   â”‚           â””â”€â”€ V8__init_skill_progress_table.sql
    â”‚   â””â”€â”€ test/
    â”‚       â””â”€â”€ [Tests placeholder for STEP 2]


ARCHITECTURE OVERVIEW
====================

API Entry Point: http://localhost:8080/api/v1

â”œâ”€â”€ POST   /auth/register          â†’ Create account + JWT token
â”œâ”€â”€ POST   /auth/login             â†’ Login + JWT token
â”‚
â”œâ”€â”€ GET    /exercises/track/{id}   â†’ List exercises (no test_code)
â”œâ”€â”€ GET    /exercises/{id}/details â†’ Exercise details (no test_code)
â”‚
â”œâ”€â”€ POST   /submissions/{exId}     â†’ Submit code (status=PENDING)
â”œâ”€â”€ GET    /submissions            â†’ User submission history
â””â”€â”€ GET    /submissions/{id}       â†’ Submission details (with result async)

[STEP 2] Async execution via Docker + Kafka
[STEP 3] Coach IA analyzes errors + generates hints
[STEP 4] WebSocket live feedback to frontend


DATABASE SCHEMA
==============

cc_user
  â”œâ”€ id (PK)
  â”œâ”€ email (UNIQUE)
  â”œâ”€ username (UNIQUE)
  â”œâ”€ password_hash (BCrypt)
  â”œâ”€ role (LEARNER | INSTRUCTOR | ADMIN)
  â””â”€ timestamps

cc_track
  â”œâ”€ id (PK)
  â”œâ”€ title
  â”œâ”€ created_by_user_id (FK)
  â””â”€ difficulty (1-5)

cc_exercise
  â”œâ”€ id (PK)
  â”œâ”€ track_id (FK)
  â”œâ”€ title
  â”œâ”€ test_code (NEVER exposed to learner!)
  â””â”€ timeout_millis, memory_limit_mb

cc_submission
  â”œâ”€ id (PK)
  â”œâ”€ exercise_id (FK)
  â”œâ”€ user_id (FK)
  â”œâ”€ code
  â”œâ”€ status (PENDING | SUCCESS | FAILED | ERROR)
  â””â”€ attempt_number

cc_submission_result
  â”œâ”€ id (PK)
  â”œâ”€ submission_id (FK, UNIQUE)
  â”œâ”€ compilation_error
  â”œâ”€ runtime_error
  â”œâ”€ tests_passed
  â”œâ”€ tests_failed
  â””â”€ execution_time_ms

cc_coach_conversation
  â”œâ”€ id (PK)
  â”œâ”€ submission_id (FK, UNIQUE)
  â”œâ”€ hint_level (1-4)
  â””â”€ context (JSON)

cc_coach_message
  â”œâ”€ id (PK)
  â”œâ”€ conversation_id (FK)
  â”œâ”€ type (QUESTION | HINT | PSEUDO_CODE | EXPLANATION)
  â””â”€ content

cc_skill_progress
  â”œâ”€ id (PK)
  â”œâ”€ user_id (FK)
  â”œâ”€ exercise_id (FK)
  â”œâ”€ successful_attempts
  â”œâ”€ total_attempts
  â””â”€ is_mastered (boolean)


TECHNOLOGY STACK
===============

Java 17 LTS
Spring Boot 3.2.1
Spring Security 6.x + JWT HMAC-SHA256
Spring Data JPA + Hibernates
PostgreSQL 15+
Flyway DB migration
Redis 6+ (optional MVP, essential STEP 2+)
Kafka (placeholder, essential STEP 2+)
Maven 3.8+ (multi-module)
Lombok (annotations)
MapStruct (DTO mapping)
Jakarta Validation


SECURITY MODEL
==============

Authentification
â”œâ”€ POST /auth/register + /auth/login
â”œâ”€ JWT token generation (HMAC-SHA256)
â””â”€ Token expiration: 24h

Authorization
â”œâ”€ Spring Security @PreAuthorize("hasRole('LEARNER')")
â”œâ”€ JWT filter extracts + validates token
â””â”€ Stateless API (no sessions)

Password Security
â”œâ”€ BCrypt hashing (12 rounds)
â”œâ”€ Never store plaintext password
â””â”€ Always validate via UserService

Execution Isolation [STEP 2]
â”œâ”€ Docker container per submission
â”œâ”€ Network disabled
â”œâ”€ CPU/memory limits
â””â”€ Timeout strict


PROJECT STATISTICS
=================

Files created:        50+
Java classes:         35+
Services:             4
Controllers:          3
Entities:             8
DTOs:                 7
Repositories:         4
DB Migrations:        8
Configuration files:  7
Documentation pages:  5
Code lines:           2000+ (excluding tests)
Test coverage:        0% (planned STEP 2+)


ROADMAP
======

âœ… STEP 1 (COMPLETED 30-JAN-2025)
   â”œâ”€ Modular Monolith architecture (9 modules)
   â”œâ”€ JWT authentication + Spring Security
   â”œâ”€ User CRUD + registration
   â”œâ”€ Exercise CRUD (read-only for learners)
   â”œâ”€ Submission system (stub without execution)
   â”œâ”€ Database schema + Flyway migrations
   â”œâ”€ REST API endpoints
   â””â”€ Documentation (README, QUICKSTART, ARCHITECTURE)

â³ STEP 2 (NEXT)
   â”œâ”€ Docker image for secure Java execution
   â”œâ”€ Kafka queue for async submissions
   â”œâ”€ Timeout + resource limits enforcement
   â”œâ”€ SubmissionResult persistence
   â””â”€ Progress tracking implementation

â³ STEP 3
   â”œâ”€ Error analysis + classification (NLP)
   â”œâ”€ Intelligent hint generation
   â”œâ”€ Socratic conversation stateful storage (Redis)
   â””â”€ Coach IA integration

â³ STEP 4
   â”œâ”€ Frontend React application
   â”œâ”€ Code editor (Monaco)
   â”œâ”€ WebSocket live feedback
   â”œâ”€ Gamification (badges, streaks)
   â””â”€ Responsive dashboard


QUICK START
===========

1. Create Database
   $ createdb -U postgres -W codecoach

2. Build
   $ cd code-coach-api
   $ mvn clean package -DskipTests

3. Run
   $ java -jar api-module/target/api-module-0.1.0-SNAPSHOT.jar

4. Test
   $ curl http://localhost:8080/api/v1/actuator/health

5. Register & Login
   $ curl -X POST http://localhost:8080/api/v1/auth/register \
     -H "Content-Type: application/json" \
     -d '{"email":"alice@example.com","username":"alice","password":"Pass123!"}'

API available at: http://localhost:8080/api/v1


KEY DECISIONS
=============

âœ… Modular Monolith (vs Microservices from day 1)
   Reason: MVP agility + easy extraction later

âœ… JWT stateless (no refresh tokens yet)
   Reason: Simple, scalable, perfect for MVP

âœ… DTOs mandatory (no entities in JSON)
   Reason: API abstraction + security

âœ… Test_code in database (never exposed)
   Reason: Immutable, secure, audit trail

âœ… Flyway migrations (SQL versioning)
   Reason: Track schema history, reproducible

âœ… Socratic coaching (not autocomplete)
   Reason: Force understanding, not just code production

âœ… Docker isolation [STEP 2]
   Reason: Safe code execution from untrusted sources

---

VERSION:  0.1.0-SNAPSHOT
DATE:     30 January 2025
STATUS:   âœ… STEP 1 COMPLETE - Ready for STEP 2
BUILT BY: Senior Software Architect & Lead Backend Engineer

---
